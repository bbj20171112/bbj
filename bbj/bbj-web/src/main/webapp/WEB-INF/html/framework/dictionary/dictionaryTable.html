<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>数据字典</title>

<!-- 引入全局css样式 -->
<script src="../../resources/framework/css-import.js"></script>

<style type="text/css">
	paginate div.page_jump {
    	float: right;
    	margin: 0 0 0 5px;
    }
    aginate div.page_jump input {
    	width: 30px;
    }
</style>

</head>
<body>
	<div class="wrapper">
		<h3 class="box-title">数据字典</h3>
		<section class="content">
			<div class="row">
				<div class="col-xs-12">
					<div class="box">
						<div class="box-header">
							<h3 class="box-title">基本表格</h3>
							<button type="button" onclick="showSelectItems()"
								class="btn btn-info">查看选中</button>
						</div>
						<!-- /.box-header -->
						<div class="box-body">
							<table id="example" class="table table-bordered table-hover">
							</table>
						</div>
						<!-- /.box-body -->
					</div>
					<!-- /.col -->
				</div>
				<!-- /.row -->
		</section>
		<!-- /.content -->
	</div>
</div>
	<!-- ./wrapper -->
	<!-- 引入JavaScripts样式 -->
	<script src="../../resources/framework/javascript-import.js"></script>
	<script type="text/javascript">
	$(function () {
		
	        	var chbx = '<input type="checkbox" class="icheckbox_minimal" id="all_checked"></th>';
				var headers = [];
				headers.push(chbx);
				headers.push("ID");
				headers.push("表名称");
				headers.push("表说明");
				headers.push("表描述");
				headers.push("序列");
				headers.push("备注");
				headers.push("操作");
	        	// console.log(data);
	        	var tableExp = $('#example').DataTable({
	        		ajax: {
	                    url: "table/queryByPage"
	                },
	                serverSide: true,
	        		searching: true, // 是否搜索
	        		processing: true, // 显示进度
	        	    ordering: true, // 是否排序
	        	    order: [[ 1, "asc" ]], // 默认排序 // desc
	        		lengthMenu: [[10,15,20], [10,15,20]], // 定义页面大小
	        		language: {
	                	processing:"正在加载中...",//这里设置就是在加载时给用户的提示
	                    lengthMenu: "每页_MENU_ 条记录",
	                    zeroRecords: "没有找到记录",
	                    info: "第 _PAGE_ 页 ( 总共 _PAGES_ 页 )",
	                    infoEmpty: "无记录",
	                    search: "搜索：",
	                    infoFiltered: "(从 _MAX_ 条记录过滤)",
	                    paginate: {
	                        previous: "上一页",
	                        next: 	  "下一页",
	                        first:    "首页",
	                        last:     "末页"
	                    }
	                },
	                pagingType: "full_numbers",
	                fnDrawCallback: function(table) {
	                	var tableId = $(table.nTable).attr("id");
                        var paginationNode = $("#"+tableId+"_paginate").find("ul[class=pagination]");
                        paginationNode.append(
                        		 '<div class="paginationJump input-group input-group-sm" style="padding:2px">'/* width:80px */
                                 + '<input type="number" class="form-control" >'
                                 + '<span class="input-group-btn">'
                                 + '<button type="button" onclick="goOnclick(this,\''+tableId+'\')" class="btn btn-info btn-flat">Go!</button>'
                                 + '</span>'
                                 + '</div>'
                        		 ); 
                        $('#example tbody').on( 'click', 'tr', function () {
                			$(this).toggleClass('selected');
                			var ichecked = $(this).find("[type=checkbox]");
                	        if(ichecked.is(':checked')){
                	        	ichecked.iCheck('uncheck');
                	        }else{
                	        	ichecked.iCheck('check');
                	        }
                	    } );
                    } ,
	        		columnDefs: [{ // 列渲染
	        				targets: 0,
	                    	render: function(data, type, row) {
	                        	return '<input type="checkbox" name="item_check" class="icheckbox_minimal">';
	                    	},
	                	},{
	               			targets: -1,
	                        render: function(data, type, row) {
	                        	var operatorDiv = '<div class="btn-group">'
	                        	+'<button type="button" onclick="row_edit('+row.id+')" class="btn btn-info">编辑</button>'
	                        	+'<button type="button" onclick="row_delete('+row.id+')" class="btn btn-danger">删除</button>'
	                        	+'</div>';
	                        	return operatorDiv;
	                       }
	                    }],
	        		columns: [ // 配置列映射（对象数据[嵌套数据：attr.id]）,如果是数组数据,直接 0,1,2,3 
	        			{ data: null , title: headers[0]},
		                { data: 'attr.id' , title: headers[1]},
		                { data: 'attr.table_name', title: headers[2]},
		                { data: 'attr.table_comment', title: headers[3]},
		                { data: 'attr.table_description', title: headers[4]},
		                { data: 'attr.sequence_name', title: headers[5]},
		                { data: 'attr.table_remark', title: headers[6]},
		                { data: null , title: headers[7]}, 
	                ]
	        	});
	        	//console.log(tableExp);
	    });
		
	    function showSelectItems() {
	        console.log( $('#example').DataTable().rows('.selected').data()[0]);
	    	alert( $('#example').DataTable().rows('.selected').data().length +' row(s) selected' );
		}
	
		//行点击事件
	    
		function goOnclick(btnJump,tableId){
			console.log(tableId);
			var table = $("#"+tableId).DataTable();
			var jumpTo = 0;
			if(btnJump.parentNode.parentNode.firstChild.value){
				jumpTo = parseInt(btnJump.parentNode.parentNode.firstChild.value) - 1;
			}
			if(jumpTo < 0){
				jumpTo = 0;
			}
			table.page(jumpTo).draw( false );
		}
	  	
	  	// 编辑事件(列点击)
	  	function row_edit(id){
			alert("您要编辑：id=" + id);
		}
		
		// 删除事件(列点击)
		function row_delete(id){
			alert("您要删除：id=" + id);
		}

	</script>
</body>
</html>